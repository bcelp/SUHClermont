<?php

namespace SUH\GestionBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * EtudiantRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class EtudiantRepository extends EntityRepository
{
    
    /**
     * retourne tous les id, noms et prénoms des étudiants handicapés de la BDD 
     * (utilisé pour l'affichage de la liste
     * @return type
     */
    public function getAllIdNameSurname()
    {
        return $this->_em->createQueryBuilder()
                ->select('e.id','e.nomEtudiant','e.prenomEtudiant')
                ->from($this->_entityName,'e')
                ->orderBy('e.nomEtudiant')
                ->addOrderBy('e.prenomEtudiant')
                ->getQuery()
                ->getResult();       
    }
    
    
    /**
     * Récupère la liste des étudiants par nom ou prenom
     * (utilisé lors de la recherche)
     * @param type $chaine
     * @return type
     */
    public function getListeEtudiantsParNomOuPrenom($chaine)
    {
        return $this->_em->createQueryBuilder()
                ->select('e.id')
                ->from($this->_entityName,'e')
                ->where('e.nomEtudiant LIKE :nom')
                ->setParameter('nom', $chaine)
                ->orWhere('e.prenomEtudiant LIKE :prenom')
                ->setParameter('prenom', '%'.$chaine.'%')
                ->addSelect('e.nomEtudiant','e.prenomEtudiant')
                ->orderBy('e.nomEtudiant')
                ->addOrderBy('e.prenomEtudiant')
                ->getQuery()
                ->getResult();       
    }    
}
